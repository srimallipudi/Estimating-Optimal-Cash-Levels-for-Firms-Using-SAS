*this program creates the industry dummies;
libname tmp1 '\\apporto.com\dfs\SEA\Users\s10_sea\Downloads\SAS_datacodes';
run;
data a1; set tmp1.dummiesraw;
data a2; set a1;
gvkey2=gvkey*1;
nyear=year(datadate);
if not missing(nyear);
if not missing(gvkey2);
if not missing(sic);
proc sort nodupkey; by gvkey2 nyear;
data a3; set a2;
drop consol indfmt datafmt popsrc curcd costat tic fyear datadate;
data a4; set a3;
if nyear>=1975;
proc sort nodupkey; by gvkey2 nyear;
data a5; set a4;
sic2=int(sic/100);
keep gvkey2 nyear cusip sic2; 
proc sort data=a5; by sic2;
proc freq data=a5 noprint; tables sic2; run;

data a6; set a5;
ind1 = (sic2 = 1);
ind2 = (sic2 = 2);
ind7 = (sic2 = 7);
ind8 = (sic2 = 8);
ind9 = (sic2 = 9);
ind10 = (sic2 = 10);
ind12 = (sic2 = 12);
ind13 = (sic2 = 13);
ind14 = (sic2 = 14);
ind15 = (sic2 = 15);
ind16 = (sic2 = 16);
ind17 = (sic2 = 17);
ind20 = (sic2 = 20);
ind21 = (sic2 = 21);
ind22 = (sic2 = 22);
ind23 = (sic2 = 23);
ind24 = (sic2 = 24);
ind25 = (sic2 = 25);
ind26 = (sic2 = 26);
ind27 = (sic2 = 27);
ind28 = (sic2 = 28);
ind29 = (sic2 = 29);
ind30 = (sic2 = 30);
ind31 = (sic2 = 31);
ind32 = (sic2 = 32);
ind33 = (sic2 = 33);
ind34 = (sic2 = 34);
ind35 = (sic2 = 35);
ind36 = (sic2 = 36);
ind37 = (sic2 = 37);
ind38 = (sic2 = 38);
ind39 = (sic2 = 39);
ind40 = (sic2 = 40);
ind41 = (sic2 = 41);
ind42 = (sic2 = 42);
ind44 = (sic2 = 44);
ind45 = (sic2 = 45);
ind46 = (sic2 = 46);
ind47 = (sic2 = 47);
ind48 = (sic2 = 48);
ind49 = (sic2 = 49);
ind50 = (sic2 = 50);
ind51 = (sic2 = 51);
ind52 = (sic2 = 52);
ind53 = (sic2 = 53);
ind54 = (sic2 = 54);
ind55 = (sic2 = 55);
ind56 = (sic2 = 56);
ind57 = (sic2 = 57);
ind58 = (sic2 = 58);
ind59 = (sic2 = 59);
ind60 = (sic2 = 60);
ind61 = (sic2 = 61);
ind62 = (sic2 = 62);
ind63 = (sic2 = 63);
ind64 = (sic2 = 64);
ind65 = (sic2 = 65);
ind67 = (sic2 = 67);
ind70 = (sic2 = 70);
ind72 = (sic2 = 72);
ind73 = (sic2 = 73);
ind75 = (sic2 = 75);
ind76 = (sic2 = 76);
ind78 = (sic2 = 78);
ind79 = (sic2 = 79);
ind80 = (sic2 = 80);
ind81 = (sic2 = 81);
ind82 = (sic2 = 82);
ind83 = (sic2 = 83);
ind84 = (sic2 = 84);
ind86 = (sic2 = 86);
ind87 = (sic2 = 87);
ind89 = (sic2 = 89);
ind99 = (sic2 = 99);

drop sic2;
data a7; set a6;
data tmp1.industrydummiesall1; set a7;
data tmp1.industrydummiesall2; set a7;
data tmp1.industrydummiesall3; set a7;
data tmp1.industrydummiesall4; set a7;
data tmp1.industrydummiesall5; set a7;
proc means; run;
/*proc print data=a7 (obs=3000);run;*/
